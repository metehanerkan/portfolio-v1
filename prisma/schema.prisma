generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// 1. PROJELER TABLOSU (Portfolio KÄ±smÄ±)
model Project {
  id           String   @id @default(cuid())
  title        String
  description  String
  technologies String[]
  githubUrl    String?
  liveUrl      String?
  imageUrl     String
  category     String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  isPublished  Boolean  @default(true)
  isFeatured   Boolean  @default(false)
  viewCount    Int      @default(0)
}

// 2. BLOG YAZILARI TABLOSU
model BlogPost {
  id          String   @id @default(cuid())
  title       String
  excerpt     String
  content     String
  imageUrl    String
  category    String
  readTime    String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  isPublished Boolean  @default(true)
  isFeatured  Boolean  @default(false)
  viewCount   Int      @default(0)
}

// 3. Ä°LETÄ°ÅžÄ°M MESAJLARI
model ContactMessage {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String   @default("Genel BaÅŸvuru")
  message   String   @db.Text // Uzun mesajlar kesilmesin diye Text yaptÄ±k
  createdAt DateTime @default(now())
  read      Boolean  @default(false)
}

// 4. MÃœÅžTERÄ° PROJELERÄ° (YÃ¶netim Paneli KÄ±smÄ±)
model ClientProject {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Temel Bilgiler
  name        String   // MÃ¼ÅŸteri AdÄ±
  email       String   // MÃ¼ÅŸteri E-postasÄ±
  accessCode  String   @unique // GiriÅŸ Kodu
  description String   @db.Text // TÃ¼m detaylÄ± baÅŸvuru formu buraya kaydedilir

  // Durum YÃ¶netimi (String yerine Enum kullanÄ±yoruz ki kodda hata yapmayalÄ±m)
  status      ProjectStatus @default(BRIEF_SUBMITTED)

  // --- ADMÄ°NÄ°N VERDÄ°ÄžÄ° TEKLÄ°F ---
  budget      String?  // Admin'in verdiÄŸi fiyat
  deadline    String?  // Admin'in verdiÄŸi tarih
  adminNotes  String?  @db.Text // Admin'in kapsam notlarÄ±

  // --- MÃœÅžTERÄ° REVÄ°ZE / PAZARLIK ---
  clientOfferPrice    String?  // MÃ¼ÅŸterinin istediÄŸi fiyat
  clientOfferDeadline String?  // MÃ¼ÅŸterinin istediÄŸi sÃ¼re
  clientOfferNotes    String?  @db.Text // MÃ¼ÅŸterinin revize notlarÄ± (Platform, Ã–zellikler vb.)

  // --- CANLI TAKÄ°P (PROGRESS) ---
  progress     Int     @default(0) // YÃ¼zde kaÃ§ bitti? (0-100)
  currentStage String? @default("HazÄ±rlÄ±k") // Åžu an ne yapÄ±lÄ±yor?
  
  // Opsiyonel alanlar (Eski yapÄ±dan kalanlar, zarar gelmez dursun)
  features     String? 
  notes        String? 
  startDate    DateTime @default(now())
  requests ProjectRequest[] // ðŸ‘ˆ YENÄ°: Talepleri projeye baÄŸladÄ±k
}

// 5. PROJE DURUMLARI (Kod iÃ§inde kullandÄ±ÄŸÄ±mÄ±z statÃ¼ler)
enum ProjectStatus {
  WAITING_BRIEF   // Beklemede
  BRIEF_SUBMITTED // Ä°nceleniyor (Ä°lk BaÅŸvuru)
  PRICING_SENT    // Teklif GÃ¶nderildi
  NEGOTIATION     // PazarlÄ±k / Revize AÅŸamasÄ±nda
  APPROVED        // OnaylandÄ± / CanlÄ± YayÄ±nda
  COMPLETED       // TamamlandÄ±
  CANCELLED       // Ä°ptal Edildi
}

model ProjectRequest {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  
  projectId String
  project   ClientProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  type      String   // 'new_feature', 'change', 'cancel', 'bug'
  message   String   @db.Text
  status    String   @default("PENDING") // PENDING (Bekliyor), APPROVED (OnaylandÄ±), REJECTED (Red)
}